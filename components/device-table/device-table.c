#include "device-table.h"

#include <stddef.h>

static const lownet_identifier_t device_table[] =
{
	// Reserved -- dead identifier.
	{{0x00,0x00,0x00,0x00,0x00,0x00}, 0},

	{{0xf0,0x24,0xf9,0x0c,0xd6,0x0c}, 0x65},
	{{0xf0,0x24,0xf9,0x0d,0xff,0xac}, 0x65},
	{{0xf0,0x24,0xf9,0x0c,0xd6,0xdc}, 0x66},
	{{0xf0,0x24,0xf9,0x0e,0x4c,0x44}, 0x67},
	{{0xf0,0x24,0xf9,0x0e,0x42,0xd0}, 0x67},
	{{0xf0,0x24,0xf9,0x0e,0x01,0xe8}, 0x68},
	{{0xf0,0x24,0xf9,0x0d,0x61,0x0c}, 0x68},
	{{0xf0,0x24,0xf9,0x0c,0xd5,0x40}, 0x69},
	{{0xf0,0x24,0xf9,0x0e,0x41,0x08}, 0x69},
	{{0xf0,0x24,0xf9,0x0e,0x95,0x0c}, 0x6a},
	{{0xf0,0x24,0xf9,0x0d,0xfd,0xa8}, 0x6b},
	{{0xf0,0x24,0xf9,0x0e,0x4b,0xb4}, 0x6c},
	{{0xf0,0x24,0xf9,0x0d,0xfb,0xbc}, 0x6c},
	{{0x00,0x4b,0x12,0x9b,0x88,0x30}, 0x6d},
	{{0xf0,0x24,0xf9,0x0e,0x94,0xf8}, 0x6d},
	{{0xf0,0x24,0xf9,0x0e,0x43,0x48}, 0x6e},
	{{0x00,0x4b,0x12,0x9b,0x84,0x40}, 0x6e},
	{{0xf0,0x24,0xf9,0x0e,0x95,0x10}, 0x6f},
	{{0x28,0x56,0x2f,0x4a,0x60,0xb8}, 0x6f},
	{{0x28,0x56,0x2f,0x77,0x9a,0xd0}, 0x70},
	{{0xf0,0x24,0xf9,0x0d,0xdb,0x68}, 0x70},
	{{0x00,0x4b,0x12,0x9b,0x4b,0xf4}, 0x71},
	{{0xf0,0x24,0xf9,0x0e,0x00,0xb0}, 0x71},
	{{0xf0,0x24,0xf9,0x0c,0xc3,0x7c}, 0x72},
	{{0x28,0x56,0x2f,0x4b,0x45,0x7c}, 0x72},
	{{0xf0,0x24,0xf9,0x0e,0x07,0x08}, 0x73},
	{{0x28,0x56,0x2f,0x4a,0x09,0x24}, 0x73},
	{{0xf0,0x24,0xf9,0x0c,0xd5,0xfc}, 0x74},
	{{0x28,0x56,0x2f,0x4a,0xd6,0x64}, 0x74},
	{{0x28,0x56,0x2f,0x4a,0x18,0x14}, 0x75},
	{{0x28,0x56,0x2f,0x4b,0x49,0x98}, 0x76},
	{{0xf0,0x24,0xf9,0x0e,0x49,0x30}, 0x76},
	{{0xf0,0x24,0xf9,0x0e,0x0d,0x1c}, 0x77},
	{{0xf0,0x24,0xf9,0x0c,0xd4,0xb8}, 0x79},
	{{0xf0,0x24,0xf9,0x0e,0xbc,0x90}, 0x7a},
	{{0xf0,0x24,0xf9,0x0e,0xc5,0x60}, 0x7b},
	{{0xf0,0x24,0xf9,0x0e,0x43,0xf0}, 0x7c},
	{{0xf0,0x24,0xf9,0x0d,0x60,0x1c}, 0x7d},
	{{0xf0,0x24,0xf9,0x0e,0x95,0x50}, 0x7e},
	{{0xf0,0x24,0xf9,0x0c,0xc3,0xf8}, 0x7f},
	{{0xf0,0x24,0xf9,0x0e,0x9d,0x38}, 0x80},
	{{0xf0,0x24,0xf9,0x0e,0x72,0xac}, 0x81},
	{{0xf0,0x24,0xf9,0x0e,0x07,0x18}, 0x82},
	{{0xf0,0x24,0xf9,0x0d,0xf7,0x8c}, 0x83},
	{{0xf0,0x24,0xf9,0x0d,0x0d,0x6c}, 0x84},
	{{0xf0,0x24,0xf9,0x0c,0xc3,0xf4}, 0x85},
	{{0x48,0xe7,0x29,0x98,0xe9,0x30}, 0x86},
	{{0xf0,0x24,0xf9,0x0e,0x49,0xa0}, 0x87},
	{{0x48,0xe7,0x29,0x99,0x22,0x14}, 0x90},

	// Master node
	{{0xb0,0xa7,0x32,0xdb,0x44,0xac}, 0xF0},

	// Broadcast identifier.
	{{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF}, 0xFF}
};

// Lookup identifier by node id.
lownet_identifier_t lownet_lookup(uint8_t id) {
	size_t size = sizeof(device_table) / sizeof(device_table[0]);
	for (int i = 0; i < size; ++i) {
		if (device_table[i].node == id) {
			return device_table[i];
		}
	}
	return device_table[0];
}

// Lookup identifier by mac address.
lownet_identifier_t lownet_lookup_mac(const uint8_t* mac) {
	size_t size = sizeof(device_table) / sizeof(device_table[0]);
	for (int i = 0; i < size; ++i) {
		int match = 1;
		for (int j = 0; j < 6; ++j) {
			if (device_table[i].mac[j] != mac[j]) {
				match = 0;
			}
		}
		if (match) {
			return device_table[i];
		}
	}
	return device_table[0];
}
